<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mandarin Dress Up Game</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            background-color: #e0f2fe; /* sky-100 */
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icon Components ---
        const Volume2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            </svg>
        );

        const RefreshCcw = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M3 2v6h6"></path>
                <path d="M21 12A9 9 0 0 0 6 5.3L3 8"></path>
                <path d="M21 22v-6h-6"></path>
                <path d="M3 12a9 9 0 0 0 15 6.7l3-2.7"></path>
            </svg>
        );

        const User = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
        );

        const Smile = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
            </svg>
        );

        // --- Main App Component ---
        const MandarinDressUp = () => {
            // Vocabulary Database
            const vocabulary = {
                action: { char: 'Á©ø‰∏ä', pinyin: 'chuƒÅn sh√†ng', en: 'Put on' },
                clothes: { char: 'Ë°£Êúç', pinyin: 'yƒ´ fu', en: 'Clothes' },
                pants: { char: 'Ë£§Â≠ê', pinyin: 'k√π zi', en: 'Pants' },
                socks: { char: 'Ë¢úÂ≠ê', pinyin: 'w√† zi', en: 'Socks' },
                shoes: { char: 'ÈûãÂ≠ê', pinyin: 'xi√© zi', en: 'Shoes' },
                mittens: { char: 'ÊâãÂ•ó', pinyin: 'sh«íu t√†o', en: 'Mittens' },
                jacket: { char: 'Â§πÂÖã', pinyin: 'ji√° k√®', en: 'Jacket' },
                hat: { char: 'Â∏ΩÂ≠ê', pinyin: 'm√†o zi', en: 'Hat' },
                skirt: { char: 'Ë£ôÂ≠ê', pinyin: 'q√∫n zi', en: 'Skirt' },
                top: { char: '‰∏äË°£', pinyin: 'sh√†ng yƒ´', en: 'Top' },
                glasses: { char: 'ÁúºÈïú', pinyin: 'y«én j√¨ng', en: 'Glasses' },
                ears: { char: 'ËÄ≥Êúµ', pinyin: 'ƒõr duo', en: 'Ears' }, 
            };

            // State
            const [gender, setGender] = useState('boy'); 
            const [bottomType, setBottomType] = useState('pants');
            
            const [wearing, setWearing] = useState({
                hat: false,
                glasses: false,
                jacket: false,
                mittens: false,
                socks: false,  
                shoes: false,  
                top: false,     
                bottom: false,  
            });
            const [selectedWord, setSelectedWord] = useState(null);

            // Text to Speech
            const speak = (text) => {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'zh-CN';
                    utterance.rate = 0.8; 
                    window.speechSynthesis.speak(utterance);
                }
            };

            const handleSelection = (key) => {
                if (!vocabulary[key]) return;
                const word = vocabulary[key];
                setSelectedWord(word);
                //speak(word.char);
            };

            // Enhanced click handler
            const handleWardrobeClick = (item) => {
                // 1. Bottoms logic
                if (item.id === 'pants') {
                    if (wearing.bottom && bottomType === 'pants') {
                        setWearing(prev => ({ ...prev, bottom: false }));
                    } else {
                        setBottomType('pants');
                        setWearing(prev => ({ ...prev, bottom: true }));
                        handleSelection('pants');
                    }
                    return;
                }
                if (item.id === 'skirt') {
                    if (wearing.bottom && bottomType === 'skirt') {
                        setWearing(prev => ({ ...prev, bottom: false }));
                    } else {
                        setBottomType('skirt');
                        setWearing(prev => ({ ...prev, bottom: true }));
                        handleSelection('skirt');
                    }
                    return;
                }

                // 2. Base items 
                if (item.id === 'top') {
                    toggleAccessory('top');
                    return;
                }

                // 3. Feet logic (Socks vs Shoes)
                if (item.id === 'socks') {
                    setWearing(prev => {
                        const newSocks = !prev.socks;
                        if (newSocks) {
                            return { ...prev, socks: true, shoes: false };
                        }
                        return { ...prev, socks: false };
                    });
                    handleSelection('socks');
                    return;
                }
                
                if (item.id === 'shoes') {
                    setWearing(prev => {
                        if (!prev.shoes) {
                             handleSelection('action'); 
                             setTimeout(() => handleSelection('shoes'), 1500);
                             return { ...prev, shoes: true };
                        } else {
                             handleSelection('shoes');
                             return { ...prev, shoes: false };
                        }
                    });
                    return;
                }

                // 4. Standard Accessories
                toggleAccessory(item.id);
            };

            const toggleAccessory = (id) => {
                setWearing(prev => {
                    const newState = { ...prev, [id]: !prev[id] };
                    if (newState[id]) {
                        handleSelection('action');
                        setTimeout(() => {
                            handleSelection(id);
                        }, 1500);
                    } else {
                        handleSelection(id);
                    }
                    return newState;
                });
            };

            const isItemActive = (id) => {
                if (id === 'pants') return wearing.bottom && bottomType === 'pants';
                if (id === 'skirt') return wearing.bottom && bottomType === 'skirt';
                if (id === 'socks') return wearing.socks; 
                if (id === 'shoes') return wearing.shoes;
                return wearing[id];
            };

            const wardrobeItems = [
                { id: 'top', label: '‰∏äË°£', icon: 'üëï' },
                { id: 'jacket', label: 'Â§πÂÖã', icon: 'üß•' },
                { id: 'pants', label: 'Ë£§Â≠ê', icon: 'üëñ' },
                { id: 'skirt', label: 'Ë£ôÂ≠ê', icon: 'üëó' },
                { id: 'socks', label: 'Ë¢úÂ≠ê', icon: 'üß¶' },
                { id: 'shoes', label: 'ÈûãÂ≠ê', icon: 'üëü' },
                { id: 'hat', label: 'Â∏ΩÂ≠ê', icon: 'üé©' },
                { id: 'glasses', label: 'ÁúºÈïú', icon: 'üëì' },
                { id: 'mittens', label: 'ÊâãÂ•ó', icon: 'üß§' },
            ];

            // --- Lego Character Component ---
            const Character = () => {
                // Lego Colors
                const skinColor = "#FACC15"; // Classic Lego Yellow
                const hairColor = gender === 'boy' ? "#5C4033" : "#D2691E"; // Dark Brown / Chocolate
                const topColor = "#3B82F6"; 
                const jacketColor = "#EF4444"; 
                const bottomColor = bottomType === 'pants' ? "#10B981" : "#EC4899"; 
                const shoeColor = "#1F2937"; // Dark grey shoes
                const sockColor = "#FFFFFF";
                const mittenColor = "#8B5CF6"; 
                const underwearColor = "#FFFFFF"; 

                // Determine foot fill color
                let leftFootFill = skinColor;
                let rightFootFill = skinColor;
                
                if (wearing.shoes) {
                    leftFootFill = shoeColor;
                    rightFootFill = shoeColor;
                } else if (wearing.socks) {
                    leftFootFill = sockColor;
                    rightFootFill = sockColor;
                }

                // C-Clamp Hand Path
                // A 'C' shape facing inwards towards body
                const leftHandPath = "M40 155 A 10 10 0 1 1 40 175 L 50 175 L 50 155 Z"; 
                // Using a stroke for simpler look usually, but fill gives more solidity
                // Let's use a thick stroke arc for classic look
                
                return (
                    <div className="relative w-64 h-96 mx-auto cursor-pointer transition-transform hover:scale-105">
                        <svg viewBox="0 0 200 400" className="w-full h-full drop-shadow-xl">
                            
                            {/* --- LAYER 1: BASE BODY (LEGO STYLE) --- */}
                            
                            {/* Head Stud */}
                            <rect x="90" y="35" width="20" height="8" fill={skinColor} />
                            
                            {/* Head (Rounded Block) */}
                            <rect x="75" y="43" width="50" height="45" rx="8" fill={skinColor} />
                            
                            {/* Neck */}
                            <rect x="85" y="88" width="30" height="15" fill={skinColor} />
                            
                            {/* Torso (Trapezoid) */}
                            {/* Top width approx 50 (neck width 30 + shoulder slope), Bottom width approx 70 */}
                            <path d="M75 103 L125 103 L135 180 L65 180 Z" fill={skinColor} />

                            {/* Arms (Angled Tubes) */}
                            {/* Left Arm */}
                            <path d="M75 110 Q50 115 45 150" stroke={skinColor} strokeWidth="16" strokeLinecap="round" fill="none" />
                            {/* Right Arm */}
                            <path d="M125 110 Q150 115 155 150" stroke={skinColor} strokeWidth="16" strokeLinecap="round" fill="none" />

                            {/* Hips (Connector) */}
                            <rect x="65" y="180" width="70" height="15" fill={skinColor} />

                            {/* Legs (Blocks) */}
                            <rect x="65" y="195" width="32" height="90" rx="2" fill={skinColor} />
                            <rect x="103" y="195" width="32" height="90" rx="2" fill={skinColor} />

                            {/* --- LAYER 2: UNDERWEAR --- */}
                            
                            {/* Undershirt (Tank top on trapezoid) */}
                            <g onClick={() => !wearing.top && handleSelection('clothes')}>
                                {/* Matches Torso shape but cropped */}
                                <path d="M78 103 L122 103 L130 170 L70 170 Z" fill={underwearColor} opacity={wearing.top ? 0 : 1} />
                            </g>
                            
                            {/* Shorts (Hips + Upper Legs) */}
                            <g onClick={() => !wearing.bottom && handleSelection('clothes')}>
                                {/* Hips */}
                                <rect x="65" y="180" width="70" height="15" fill={underwearColor} opacity={wearing.bottom ? 0 : 1} />
                                {/* Upper Legs */}
                                <rect x="65" y="195" width="32" height="25" fill={underwearColor} opacity={wearing.bottom ? 0 : 1} />
                                <rect x="103" y="195" width="32" height="25" fill={underwearColor} opacity={wearing.bottom ? 0 : 1} />
                            </g>


                            {/* --- LAYER 3: CLOTHING --- */}
                            
                            {/* Bottoms */}
                            {wearing.bottom && (
                                bottomType === 'pants' ? (
                                    <g onClick={() => handleSelection('pants')}>
                                        {/* Hips */}
                                        <rect x="65" y="180" width="70" height="15" fill={bottomColor} />
                                        {/* Legs */}
                                        <rect x="65" y="195" width="32" height="90" rx="2" fill={bottomColor} />
                                        <rect x="103" y="195" width="32" height="90" rx="2" fill={bottomColor} />
                                        {/* Detail lines */}
                                        <rect x="65" y="285" width="32" height="10" fill="rgba(0,0,0,0.1)" />
                                        <rect x="103" y="285" width="32" height="10" fill="rgba(0,0,0,0.1)" />
                                    </g>
                                ) : (
                                    <g onClick={() => handleSelection('skirt')}>
                                         {/* Hips */}
                                        <rect x="65" y="180" width="70" height="15" fill={bottomColor} />
                                        {/* Skirt Block */}
                                        <path d="M65 195 L135 195 L145 270 L55 270 Z" fill={bottomColor} />
                                    </g>
                                )
                            )}

                            {/* Top */}
                            {wearing.top && (
                                <g onClick={() => handleSelection('top')}>
                                    {/* Torso */}
                                    <path d="M75 103 L125 103 L135 180 L65 180 Z" fill={topColor} />
                                    {/* Sleeve Arms */}
                                    <path d="M75 110 Q50 115 48 135" stroke={topColor} strokeWidth="16" strokeLinecap="round" fill="none" />
                                    <path d="M125 110 Q150 115 152 135" stroke={topColor} strokeWidth="16" strokeLinecap="round" fill="none" />
                                    {/* Decoration */}
                                    <path d="M100 103 L100 180" stroke="rgba(0,0,0,0.1)" strokeWidth="1" />
                                </g>
                            )}

                            {/* Jacket */}
                            {wearing.jacket && (
                                <g onClick={(e) => { e.stopPropagation(); handleSelection('jacket'); }}>
                                    {/* Open Jacket Look */}
                                    <path d="M73 100 L127 100 L138 185 L62 185 Z" fill={jacketColor} />
                                    {/* Zipper opening (White triangle) */}
                                    <path d="M90 100 L110 100 L100 185 Z" fill={wearing.top ? topColor : underwearColor} />
                                    {/* Sleeves */}
                                    <path d="M73 108 Q48 113 43 145" stroke={jacketColor} strokeWidth="18" strokeLinecap="round" fill="none" />
                                    <path d="M127 108 Q152 113 157 145" stroke={jacketColor} strokeWidth="18" strokeLinecap="round" fill="none" />
                                </g>
                            )}

                            {/* Feet (Socks/Shoes/Skin) */}
                            {/* Just coloring bottom of block legs */}
                            {(wearing.shoes || wearing.socks) && (
                                <g onClick={() => {
                                    if (wearing.shoes) handleSelection('shoes');
                                    else if (wearing.socks) handleSelection('socks');
                                }}>
                                    {/* Left Foot Block */}
                                    <rect x="65" y="285" width="32" height="12" rx="2" fill={wearing.shoes ? shoeColor : sockColor} />
                                    {/* Right Foot Block */}
                                    <rect x="103" y="285" width="32" height="12" rx="2" fill={wearing.shoes ? shoeColor : sockColor} />
                                </g>
                            )}

                            {/* Hands (Claws) */}
                            <g onClick={() => handleSelection(wearing.mittens ? 'mittens' : 'clothes')}>
                                {wearing.mittens ? (
                                    <>
                                        {/* Mitten Blob */}
                                        <circle cx="45" cy="155" r="14" fill={mittenColor} />
                                        <circle cx="155" cy="155" r="14" fill={mittenColor} />
                                    </>
                                ) : (
                                    <>
                                        {/* Left Hand Claw - Thick Stroke Arc */}
                                        <path d="M38 145 A 10 10 0 1 0 38 165" stroke={skinColor} strokeWidth="10" fill="none" strokeLinecap="round" transform="rotate(-20 45 155)" />
                                        {/* Right Hand Claw */}
                                        <path d="M162 145 A 10 10 0 1 1 162 165" stroke={skinColor} strokeWidth="10" fill="none" strokeLinecap="round" transform="rotate(20 155 155)" />
                                    </>
                                )}
                            </g>

                            {/* Face (Printed Style) */}
                             <g onClick={() => handleSelection('ears')}>
                                {/* Eyes - Simple Black Dots with Shine */}
                                <circle cx="85" cy="60" r="4" fill="#000" />
                                <circle cx="83" cy="58" r="1.5" fill="#FFF" />
                                <circle cx="115" cy="60" r="4" fill="#000" />
                                <circle cx="113" cy="58" r="1.5" fill="#FFF" />
                                
                                {/* Smile - Simple Curved Line */}
                                <path d="M90 70 Q100 80 110 70" stroke="#000" strokeWidth="3" fill="none" strokeLinecap="round" />
                                {/* Cheek Tint */}
                                <circle cx="80" cy="70" r="3" fill="#ECA58D" opacity="0.5" />
                                <circle cx="120" cy="70" r="3" fill="#ECA58D" opacity="0.5" />
                            </g>

                            {/* Hair (Snap-on Hair Piece) */}
                            {gender === 'boy' ? (
                                // Boy Hair Piece
                                <path d="M70 45 Q100 25 130 45 L132 55 Q135 60 130 65 L125 55 L75 55 L70 65 Q65 60 68 55 Z" fill={hairColor} transform="translate(0, -5)" />
                            ) : (
                                // Girl Hair Piece (Bob with slope)
                                <g transform="translate(0, -5)">
                                    <path d="M68 45 Q100 25 132 45 L135 85 L125 85 L125 55 L75 55 L75 85 L65 85 Z" fill={hairColor} />
                                </g>
                            )}

                            {/* Glasses */}
                            {wearing.glasses && (
                                <g onClick={(e) => { e.stopPropagation(); handleSelection('glasses'); }} className="cursor-pointer hover:stroke-indigo-600">
                                    <rect x="78" y="55" width="14" height="10" rx="2" fill="none" stroke="black" strokeWidth="2" />
                                    <rect x="108" y="55" width="14" height="10" rx="2" fill="none" stroke="black" strokeWidth="2" />
                                    <line x1="92" y1="60" x2="108" y2="60" stroke="black" strokeWidth="2" />
                                </g>
                            )}

                            {/* Hat */}
                            {wearing.hat && (
                                <g onClick={(e) => { e.stopPropagation(); handleSelection('hat'); }} className="cursor-pointer hover:brightness-110">
                                    {/* Sits on top of stud */}
                                    <path d="M60 40 L140 40 L110 10 L90 10 Z" fill="#F59E0B" />
                                    <rect x="55" y="38" width="90" height="5" fill="#B45309" />
                                </g>
                            )}

                        </svg>

                        {/* Fallback Click */}
                        <div className="absolute top-[100px] left-[60px] w-[80px] h-[100px] bg-transparent pointer-events-none"></div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-sky-100 font-sans p-4 flex flex-col items-center">
                    
                    {/* HEADER */}
                    <header className="w-full max-w-4xl bg-white rounded-2xl shadow-lg p-4 mb-6 flex justify-between items-center">
                        <h1 className="text-2xl md:text-3xl font-bold text-sky-600 flex items-center gap-2">
                            <Smile className="w-8 h-8" />
                            Mandarin Dress Up (Lego Style)
                        </h1>
                        <button 
                            onClick={() => {
                                setWearing({ hat: false, glasses: false, jacket: false, mittens: false, shoes: false, socks: false, top: false, bottom: false });
                                setSelectedWord(null);
                            }}
                            className="bg-gray-200 p-2 rounded-full hover:bg-gray-300 transition"
                            title="Reset"
                        >
                            <RefreshCcw size={20} />
                        </button>
                    </header>

                    <div className="w-full max-w-5xl flex flex-col md:flex-row gap-6 items-start justify-center">
                        
                        {/* LEFT: CONTROLS */}
                        <div className="w-full md:w-1/4 flex flex-col gap-4">
                            
                            {/* Gender */}
                            <div className="bg-white p-4 rounded-xl shadow-md">
                                <h3 className="text-gray-500 text-sm font-bold uppercase mb-3">Model</h3>
                                <div className="flex bg-gray-100 rounded-lg p-1">
                                    <button 
                                        className={`flex-1 py-2 rounded-md font-bold transition ${gender === 'boy' ? 'bg-blue-500 text-white shadow' : 'text-gray-500 hover:bg-gray-200'}`}
                                        onClick={() => setGender('boy')}
                                    >
                                        Boy
                                    </button>
                                    <button 
                                        className={`flex-1 py-2 rounded-md font-bold transition ${gender === 'girl' ? 'bg-pink-500 text-white shadow' : 'text-gray-500 hover:bg-gray-200'}`}
                                        onClick={() => setGender('girl')}
                                    >
                                        Girl
                                    </button>
                                </div>
                            </div>

                            {/* Wardrobe */}
                            <div className="bg-white p-4 rounded-xl shadow-md">
                                <h3 className="text-gray-500 text-sm font-bold uppercase mb-3">Wardrobe</h3>
                                <div className="grid grid-cols-2 gap-2">
                                    {wardrobeItems.map((item) => {
                                        const active = isItemActive(item.id);
                                        return (
                                            <button
                                                key={item.id}
                                                onClick={() => handleWardrobeClick(item)}
                                                className={`flex flex-col items-center justify-center p-2 rounded-lg border-2 transition h-20 ${
                                                    active 
                                                        ? 'border-sky-500 bg-sky-50 text-sky-700 shadow-inner' 
                                                        : 'border-gray-200 text-gray-500 hover:border-sky-200 bg-white hover:bg-gray-50'
                                                }`}
                                            >
                                                <span className="text-2xl mb-1">{item.icon}</span>
                                                <span className="font-bold text-xs">{item.label}</span>
                                                {active && <div className="w-2 h-2 rounded-full bg-sky-500 mt-1" />}
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>
                            
                            {/* General Clothes Button
                            <button 
                                onClick={() => handleSelection('clothes')}
                                className="bg-white hover:bg-orange-50 border-2 border-orange-200 text-orange-600 font-bold py-3 rounded-xl shadow-sm transition"
                            >
                                Show "Clothes" (Ë°£Êúç)
                            </button> */}

                        </div>

                        {/* CENTER: STAGE */}
                        <div className="w-full md:w-1/3 bg-white rounded-3xl shadow-xl p-8 flex flex-col items-center justify-center relative border-b-8 border-sky-100 min-h-[400px]">
                            <div className="absolute top-4 left-4 text-gray-400 text-sm">
                                Click the body parts!
                            </div>
                            <Character />
                            <div className="mt-6 text-center text-gray-500 font-medium">
                                {gender === 'boy' ? 'Lego Boy' : 'Lego Girl'}
                            </div>
                        </div>

                        {/* RIGHT: FLASHCARD */}
                        <div className="w-full md:w-1/3 flex flex-col gap-4 h-full">
                            <div className={`w-full bg-white rounded-3xl shadow-xl p-6 flex flex-col items-center justify-center text-center transition-all duration-300 border-4 ${selectedWord ? 'border-yellow-400 scale-100 opacity-100' : 'border-transparent scale-95 opacity-50'}`}>
                                
                                {selectedWord ? (
                                    <>
                                        <div className="text-sm text-gray-400 font-bold tracking-wider uppercase mb-2">Selected Word</div>
                                        
                                        <div className="text-7xl font-bold text-gray-800 mb-2">
                                            {selectedWord.char}
                                        </div>
                                        
                                        <div className="text-3xl text-sky-600 font-medium mb-4 font-serif">
                                            {selectedWord.pinyin}
                                        </div>
                                        
                                        <div className="text-xl text-gray-500 mb-8 border-t border-gray-100 pt-4 w-full">
                                            {selectedWord.en}
                                        </div>

                                        
                                    </>
                                ) : (
                                    <div className="py-20 text-gray-400">
                                        <User size={64} className="mx-auto mb-4 opacity-20" />
                                        <p>Click on an item<br/>to see the word!</p>
                                    </div>
                                )}
                            </div>

                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MandarinDressUp />);
    </script>
</body>
</html>